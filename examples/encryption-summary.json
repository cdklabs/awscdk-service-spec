{
  "metadata": {
    "title": "AWS Resource Encryption at Rest Configuration Summary",
    "generated": "2024",
    "resources_analyzed": 10,
    "source": "CloudFormation Resource Provider Schemas"
  },
  "resources": [
    {
      "cloudFormationType": "AWS::S3::Bucket",
      "encryptionProperties": [
        {
          "name": "BucketEncryption",
          "required": false,
          "type": "complex",
          "structure": {
            "ServerSideEncryptionConfiguration": {
              "type": "array",
              "items": "ServerSideEncryptionRule",
              "nested": {
                "BucketKeyEnabled": "boolean",
                "ServerSideEncryptionByDefault": {
                  "SSEAlgorithm": ["aws:kms", "AES256", "aws:kms:dsse"],
                  "KMSMasterKeyID": "string (optional)"
                }
              }
            }
          },
          "defaultBehavior": "No encryption unless specified"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::DynamoDB::Table",
      "encryptionProperties": [
        {
          "name": "SSESpecification",
          "required": false,
          "type": "complex",
          "defaultBehavior": "AWS-owned key encryption by default"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::RDS::DBInstance",
      "encryptionProperties": [
        {
          "name": "StorageEncrypted",
          "required": false,
          "type": "boolean",
          "defaultBehavior": "Not encrypted by default"
        },
        {
          "name": "KmsKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Uses default KMS key if StorageEncrypted=true and KmsKeyId not specified"
        },
        {
          "name": "PerformanceInsightsKMSKeyId",
          "required": false,
          "type": "string",
          "purpose": "Encryption for Performance Insights data"
        },
        {
          "name": "AutomaticBackupReplicationKmsKeyId",
          "required": false,
          "type": "string",
          "purpose": "Encryption for replicated automated backups"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::EC2::Volume",
      "encryptionProperties": [
        {
          "name": "Encrypted",
          "required": false,
          "type": "boolean",
          "defaultBehavior": "Depends on account encryption-by-default setting"
        },
        {
          "name": "KmsKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Uses default key if Encrypted=true and KmsKeyId not specified"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::EFS::FileSystem",
      "encryptionProperties": [
        {
          "name": "Encrypted",
          "required": false,
          "type": "boolean",
          "defaultBehavior": "Not encrypted by default"
        },
        {
          "name": "KmsKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Uses /aws/elasticfilesystem if Encrypted=true and KmsKeyId not specified"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::SNS::Topic",
      "encryptionProperties": [
        {
          "name": "KmsMasterKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Not encrypted unless KmsMasterKeyId is specified"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::SQS::Queue",
      "encryptionProperties": [
        {
          "name": "KmsMasterKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Not encrypted unless KmsMasterKeyId is specified"
        },
        {
          "name": "KmsDataKeyReusePeriodSeconds",
          "required": false,
          "type": "integer",
          "defaultBehavior": "300 seconds (5 minutes)",
          "range": "60-86400"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::Kinesis::Stream",
      "encryptionProperties": [
        {
          "name": "StreamEncryption",
          "required": false,
          "type": "complex",
          "defaultBehavior": "Not encrypted by default"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::SecretsManager::Secret",
      "encryptionProperties": [
        {
          "name": "KmsKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Uses aws/secretsmanager default key if not specified"
        }
      ]
    },
    {
      "cloudFormationType": "AWS::Logs::LogGroup",
      "encryptionProperties": [
        {
          "name": "KmsKeyId",
          "required": false,
          "type": "string",
          "defaultBehavior": "Not encrypted unless KmsKeyId is specified"
        }
      ]
    }
  ],
  "patterns": {
    "boolean_plus_kms": {
      "description": "Boolean flag to enable encryption + separate KMS key property",
      "examples": ["AWS::EC2::Volume", "AWS::EFS::FileSystem", "AWS::RDS::DBInstance"]
    },
    "complex_object": {
      "description": "Single property referencing complex nested configuration",
      "examples": ["AWS::S3::Bucket", "AWS::DynamoDB::Table", "AWS::Kinesis::Stream"]
    },
    "kms_only": {
      "description": "Single KMS key property, encryption implied when set",
      "examples": ["AWS::SNS::Topic", "AWS::SQS::Queue", "AWS::SecretsManager::Secret", "AWS::Logs::LogGroup"]
    }
  }
}
